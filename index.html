<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Generador de tablas de frecuencia</title>
    <link rel="stylesheet" href="index.css">
    <style>
        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }
    </style>
</head>

<script>
    const dataset = [];

    function onDataEntered(dataList, data) {
        const num = parseFloat(data);
        if (data === 0 || data === "" || isNaN(num)) return;
        console.log(data);
        const newData = document.createElement("li");
        newData.textContent = data;
        dataList.appendChild(newData);
        dataset.push(num);
    }
</script>
<body>

<header id="banner">
    <h1 class="Title">Tabla de Frecuencias</h1>
    <h2 class="subTitle">Ingrese los datos:</h2>
    <input id="data" placeholder="presione enter al terminar">
    <button id="dataCompletaBtn">Dataset completo</button>
</header>

<ul id="dataList">

</ul>
<div id="reporteVariables">
</div>
<table id="tablaDeFrecuencias">
    <tr>
        <th>Categoria</th>
        <th>fi</th>
        <th>fri</th>
        <th>Fi</th>
        <th>Fri</th>
        <th>mi</th>
        <th>mi*fi</th>
    </tr>
</table>
<script>
    const data = document.getElementById("data");
    const dataList = document.getElementById("dataList");
    data.addEventListener("keyup", (event) => {
        if (event.key === "Enter") {
            onDataEntered(dataList, data.value);
            data.value = "";
        }
    });
    const reporteVariables = document.getElementById("reporteVariables");
    const tablaDeFrecuencias = document.getElementById("tablaDeFrecuencias");
    const dataCompletaBtn = document.getElementById("dataCompletaBtn");
    dataCompletaBtn.addEventListener('click', function (event) {
        event.preventDefault();
        const reporte = document.createElement("p");
        const n = dataset.length;
        const nroCategorias = Math.round(1 + 3.33 * Math.log10(n));
        let vMin = dataset[0];
        let vMax = dataset[0];
        dataset.forEach((num) => {
            if (num < vMin)
                vMin = num;
            if (num > vMax)
                vMax = num;
        });
        const rango = vMax - vMin;
        const amplitud = Math.ceil(rango / nroCategorias);
        const texto = "n=" + n + " k=" + nroCategorias + " rango=" + rango + " c=" + amplitud;
        reporte.textContent = texto;
        reporteVariables.appendChild(reporte);

        let ultimoLimiteInferior = vMin;
        let ultimoFi = 0;
        for (let j = 0; j < nroCategorias; j++) {
            const limInf = ultimoLimiteInferior;
            const limSup = limInf + amplitud;

            const fila = document.createElement("tr");

            const intervalo = document.createElement("th");
            intervalo.innerText = "[" + limInf + ", " + limSup + ")";
            fila.appendChild(intervalo);

            const fi = document.createElement("th");
            const fiValue = dataset.filter((value) => value <= limSup && value >= limInf).length || 0;
            fi.innerText = fiValue;
            fila.appendChild(fi);

            const fri = document.createElement("th");
            fri.innerText = fiValue / n;
            fila.appendChild(fri);

            const Fi = document.createElement("th");
            const FiValue = ultimoFi + fiValue;
            Fi.innerText = FiValue;
            fila.appendChild(Fi);

            const Fri = document.createElement("th");
            Fri.innerText = FiValue / n;
            fila.appendChild(Fri);

            const mi = document.createElement("th");
            const miValue = (limInf + limSup) / 2;
            mi.innerText = miValue;
            fila.appendChild(mi);

            const mifi = document.createElement("th");
            mifi.innerText = miValue * fiValue;
            ultimoLimiteInferior = limSup;

            tablaDeFrecuencias.appendChild(fila)
        }

    }, false);
</script>
</body>
</html>